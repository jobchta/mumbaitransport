<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#5E6AD2">
    <title>Mumbai Transport Hub | Real-Time Tracking</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.0.0/mapbox-gl.css" rel="stylesheet">
    <style>
        :root {
            --primary: #5E6AD2;
            --primary-dark: #4C56C4;
            --primary-light: #F1F2FD;
            --secondary: #8B92B2;
            --background: #FAFBFC;
            --surface: #FFFFFF;
            --surface-hover: #F7F8FA;
            --border: #E1E4E8;
            --border-light: #F1F3F4;
            --text-primary: #1D2125;
            --text-secondary: #626F86;
            --text-muted: #8B92B2;
            --success: #00B87A;
            --warning: #F79009;
            --error: #DC3A42;
            --info: #0EA5E9;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.12);
            --radius-sm: 6px;
            --radius-md: 8px;
            --radius-lg: 12px;
            --radius-xl: 16px;
        }

        [data-theme="dark"] {
            --background: #0F1419;
            --surface: #1A1D23;
            --surface-hover: #222530;
            --border: #2D3442;
            --border-light: #252932;
            --text-primary: #FFFFFF;
            --text-secondary: #9CA3AF;
            --text-muted: #6B7280;
            --primary-light: rgba(94, 106, 210, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--background);
            color: var(--text-primary);
            line-height: 1.5;
            font-size: 14px;
            overflow: hidden;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            transition: background 0.3s ease, color 0.3s ease;
        }

        .app {
            height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        .header {
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            padding: 16px 20px 12px;
            position: relative;
            z-index: 100;
            backdrop-filter: blur(8px);
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            flex-direction: column;
            gap: 12px;
            flex-shrink: 0;
        }

        [data-theme="dark"] .header {
            background: rgba(26, 29, 35, 0.9);
        }

        .header-top { display: flex; align-items: center; justify-content: space-between; }
        .logo { font-size: 18px; font-weight: 700; color: var(--text-primary); letter-spacing: -0.2px; display: flex; align-items: center; gap: 8px; }
        .logo-icon { width: 28px; height: 28px; background: var(--primary); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; color: white; }
        .header-actions { display: flex; gap: 10px; }
        .header-btn { width: 36px; height: 36px; border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; background: var(--background); border: 1px solid var(--border); color: var(--text-muted); cursor: pointer; transition: all 0.2s ease; }
        .header-btn:hover { background: var(--surface-hover); }
        .header-btn:focus { outline: none; box-shadow: 0 0 0 3px rgba(94, 106, 210, 0.3); }

        .search-bar { position: relative; }
        .search-input { width: 100%; padding: 12px 16px 12px 44px; background: var(--background); border: 1px solid var(--border); border-radius: var(--radius-md); font-size: 14px; color: var(--text-primary); outline: none; transition: all 0.2s ease; }
        .search-input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(94, 106, 210, 0.1); }
        .search-icon { position: absolute; left: 16px; top: 50%; transform: translateY(-50%); color: var(--text-muted); font-size: 16px; }

        .content {
            flex: 1;
            padding: 16px 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .section-title { font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        .section-title i { color: var(--primary); }

        .transport-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 12px; }
        .transport-card { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 16px; transition: all 0.2s ease; cursor: pointer; position: relative; overflow: hidden; display: flex; flex-direction: column; gap: 8px; }
        .transport-card.active { border-color: var(--primary); background: var(--primary-light); }
        .transport-card:focus { outline: none; box-shadow: 0 0 0 3px rgba(94, 106, 210, 0.3); }
        .card-header { display: flex; align-items: center; gap: 10px; }
        .card-icon { width: 40px; height: 40px; border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; font-size: 18px; color: white; flex-shrink: 0; }
        .bus-icon { background: var(--primary); }
        .train-icon { background: var(--success); }
        .metro-icon { background: #8B5CF6; }
        .ferry-icon { background: var(--info); }
        .card-title { font-size: 14px; font-weight: 600; color: var(--text-primary); line-height: 1.2; }
        .card-status { display: flex; align-items: center; gap: 6px; }
        .status-indicator { width: 8px; height: 8px; border-radius: 50%; }
        .status-active { background: var(--success); }
        .status-delayed { background: var(--warning); }
        .status-offline { background: var(--error); }
        .card-status-text { font-size: 12px; color: var(--text-muted); }
        .card-stats { display: flex; justify-content: space-between; margin-top: auto; padding-top: 8px; }
        .stat { text-align: center; flex: 1; }
        .stat-number { font-size: 16px; font-weight: 700; color: var(--text-primary); line-height: 1; }
        .stat-label { font-size: 11px; color: var(--text-muted); margin-top: 4px; }

        .action-grid { display: grid; grid-template-columns: repeat(2, 1fr)); gap: 10px; }
        .action-button { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-md); padding: 14px; font-size: 13px; color: var(--text-secondary); font-weight: 500; cursor: pointer; transition: all 0.2s ease; text-align: left; display: flex; align-items: center; gap: 10px; }
        .action-button:focus { outline: none; box-shadow: 0 0 0 3px rgba(94, 106, 210, 0.3); }
        .action-icon { width: 32px; height: 32px; border-radius: var(--radius-sm); background: var(--primary-light); display: flex; align-items: center; justify-content: center; color: var(--primary); font-size: 16px; flex-shrink: 0; }
        
        .map-container { height: 200px; border-radius: var(--radius-lg); overflow: hidden; position: relative; border: 1px solid var(--border); }
        .mapboxgl-map { width: 100%; height: 100%; }
        .mapboxgl-ctrl-logo, .mapboxgl-ctrl-attrib { display: none; }
        .map-controls { position: absolute; top: 12px; right: 12px; z-index: 2; display: flex; gap: 8px; }
        .map-btn { background: var(--surface); border: none; width: 36px; height: 36px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: var(--shadow-md); cursor: pointer; transition: all 0.3s ease; color: var(--text-muted); }
        .map-btn:focus { outline: none; box-shadow: 0 0 0 3px rgba(94, 106, 210, 0.3); }
        
        .updates-list { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-lg); overflow: hidden; }
        .update-item { padding: 14px 16px; border-bottom: 1px solid var(--border-light); display: flex; align-items: flex-start; gap: 12px; }
        .update-item:last-child { border-bottom: none; }
        .update-icon { width: 32px; height: 32px; border-radius: var(--radius-sm); display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; color: white; }
        .update-content { flex: 1; min-width: 0; }
        .update-text { font-size: 13px; color: var(--text-primary); line-height: 1.4; margin-bottom: 4px; }
        .update-time { font-size: 11px; color: var(--text-muted); display: flex; align-items: center; gap: 6px; }

        .bottom-nav { background: var(--surface); border-top: 1px solid var(--border); padding: 8px 20px; display: grid; grid-template-columns: repeat(4, 1fr)); gap: 8px; flex-shrink: 0; }
        .nav-button { padding: 8px 4px; border-radius: var(--radius-md); background: transparent; border: none; color: var(--text-muted); font-size: 11px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; display: flex; flex-direction: column; align-items: center; gap: 4px; }
        .nav-button.active { color: var(--primary); }
        .nav-button:focus { outline: none; box-shadow: 0 0 0 3px rgba(94, 106, 210, 0.3); }
        .nav-icon { font-size: 20px; }

        .offline-banner { background: var(--warning); color: white; padding: 8px 20px; font-size: 12px; text-align: center; font-weight: 500; display: none; }
        .offline-banner.show { display: block; }

        .loading { display: flex; justify-content: center; padding: 16px; }
        .loading-spinner { width: 24px; height: 24px; border: 3px solid rgba(94, 106, 210, 0.2); border-top-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .modal { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.5); z-index: 1000; display: flex; justify-content: center; align-items: center; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; }
        .modal.active { opacity: 1; pointer-events: all; }
        .modal-content { background: var(--surface); border-radius: var(--radius-lg); width: 90%; max-width: 400px; max-height: 90vh; display: flex; flex-direction: column; transform: translateY(20px); transition: transform 0.3s ease; }
        .modal.active .modal-content { transform: translateY(0); }
        .modal-header { padding: 16px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .modal-title { font-size: 18px; font-weight: 600; color: var(--text-primary); }
        .modal-close { background: none; border: none; font-size: 20px; color: var(--text-muted); cursor: pointer; }
        .modal-body { padding: 16px; overflow-y: auto; }
        .form-group { margin-bottom: 16px; }
        .form-label { display: block; margin-bottom: 8px; font-size: 13px; color: var(--text-muted); font-weight: 500; }
        .form-input { width: 100%; padding: 12px 16px; background: var(--background); border: 1px solid var(--border); border-radius: var(--radius-md); font-size: 14px; color: var(--text-primary); outline: none; transition: all 0.2s ease; }
        .form-input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(94, 106, 210, 0.1); }
        .form-submit { background: var(--primary); color: white; border: none; border-radius: var(--radius-md); padding: 14px; font-size: 14px; font-weight: 600; width: 100%; cursor: pointer; transition: background 0.2s ease; }
        .form-submit:hover { background: var(--primary-dark); }
        .form-submit:disabled { background: var(--text-muted); cursor: not-allowed; }
        
        .route-results { margin-top: 16px; border-top: 1px solid var(--border); padding-top: 16px; }
        .route-option { padding: 12px; border-radius: var(--radius-md); background: var(--background); margin-bottom: 12px; border: 1px solid var(--border); cursor: pointer; }
        .route-option:hover { border-color: var(--primary); }
        .route-option:focus { outline: none; box-shadow: 0 0 0 3px rgba(94, 106, 210, 0.3); }
        .route-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .route-summary { display: flex; align-items: center; gap: 4px; flex-wrap: wrap; }
        .route-icon { width: 24px; height: 24px; border-radius: var(--radius-sm); display: flex; align-items: center; justify-content: center; color: white; font-size: 14px; }
        .route-info { display: flex; flex-direction: column; align-items: flex-end; }
        .route-duration { font-weight: 600; font-size: 14px; }
        .route-distance { font-size: 12px; color: var(--text-muted); }

        .schedule-list { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius-lg); overflow: hidden; }
        .schedule-item { padding: 14px 16px; border-bottom: 1px solid var(--border-light); display: flex; align-items: center; gap: 12px; }
        .schedule-item:last-child { border-bottom: none; }
        .schedule-icon { width: 32px; height: 32px; border-radius: var(--radius-sm); display: flex; align-items: center; justify-content: center; font-size: 14px; flex-shrink: 0; color: white; }
        .schedule-content { flex: 1; min-width: 0; }
        .schedule-route { font-size: 13px; font-weight: 600; color: var(--text-primary); }
        .schedule-time { font-size: 12px; color: var(--text-muted); }

        .empty-state { padding: 24px; text-align: center; color: var(--text-muted); display: flex; flex-direction: column; align-items: center; gap: 8px; }
        .empty-icon { font-size: 24px; color: var(--text-muted); }

        @media (max-width: 380px) {
            .action-grid, .transport-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Real-time indicators */
        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 10px;
            font-weight: 600;
            color: var(--error);
            background: rgba(220, 58, 66, 0.1);
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 8px;
        }
        
        .live-indicator::before {
            content: "";
            display: block;
            width: 6px;
            height: 6px;
            background: var(--error);
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.4; }
            100% { opacity: 1; }
        }
        
        /* Route line animation */
        .mapboxgl-route-animation {
            stroke-width: 4;
            stroke: #5E6AD2;
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: dash 10s linear infinite;
        }
        
        @keyframes dash {
            to {
                stroke-dashoffset: 0;
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <header class="header">
            <div class="header-top">
                <div class="logo">
                    <div class="logo-icon"><i class="fa-solid fa-train-subway"></i></div>
                    Mumbai Transport Hub
                </div>
                <div class="header-actions">
                    <button class="header-btn" id="theme-toggle" aria-label="Switch theme">
                        <i class="fa-solid fa-moon"></i>
                    </button>
                    <button class="header-btn" aria-label="Notifications">
                        <i class="fa-solid fa-bell"></i>
                    </button>
                </div>
            </div>
            <div class="search-bar">
                <i class="fa-solid fa-magnifying-glass search-icon"></i>
                <input type="text" class="search-input" placeholder="Search routes or destinations..." aria-label="Search routes or destinations">
            </div>
        </header>
        
        <main class="content">
            <section>
                <h2 class="section-title"><i class="fa-solid fa-bus"></i> Transport Modes <span class="live-indicator">LIVE</span></h2>
                <div class="transport-grid">
                    <div class="transport-card active">
                        <div class="card-header">
                            <div class="bus-icon card-icon"><i class="fa-solid fa-bus"></i></div>
                            <div class="card-title">BEST Buses</div>
                        </div>
                        <div class="card-status">
                            <span class="status-indicator status-active"></span>
                            <span class="card-status-text">Operational</span>
                        </div>
                        <div class="card-stats">
                            <div class="stat">
                                <span class="stat-number">1,200+</span>
                                <span class="stat-label">Buses</span>
                            </div>
                            <div class="stat">
                                <span class="stat-number">92%</span>
                                <span class="stat-label">On Time</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="transport-card">
                        <div class="card-header">
                            <div class="train-icon card-icon"><i class="fa-solid fa-train-subway"></i></div>
                            <div class="card-title">Local Trains</div>
                        </div>
                        <div class="card-status">
                            <span class="status-indicator status-delayed"></span>
                            <span class="card-status-text">Minor Delays</span>
                        </div>
                        <div class="card-stats">
                            <div class="stat">
                                <span class="stat-number">3,500+</span>
                                <span class="stat-label">Trips</span>
                            </div>
                            <div class="stat">
                                <span class="stat-number">87%</span>
                                <span class="stat-label">On Time</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="transport-card">
                        <div class="card-header">
                            <div class="metro-icon card-icon"><i class="fa-solid fa-train-tram"></i></div>
                            <div class="card-title">Metro</div>
                        </div>
                        <div class="card-status">
                            <span class="status-indicator status-active"></span>
                            <span class="card-status-text">Operational</span>
                        </div>
                        <div class="card-stats">
                            <div class="stat">
                                <span class="stat-number">12</span>
                                <span class="stat-label">Lines</span>
                            </div>
                            <div class="stat">
                                <span class="stat-number">98%</span>
                                <span class="stat-label">On Time</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="transport-card">
                        <div class="card-header">
                            <div class="ferry-icon card-icon"><i class="fa-solid fa-ship"></i></div>
                            <div class="card-title">Ferry</div>
                        </div>
                        <div class="card-status">
                            <span class="status-indicator status-active"></span>
                            <span class="card-status-text">Operational</span>
                        </div>
                        <div class="card-stats">
                            <div class="stat">
                                <span class="stat-number">8</span>
                                <span class="stat-label">Routes</span>
                            </div>
                            <div class="stat">
                                <span class="stat-number">95%</span>
                                <span class="stat-label">On Time</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section>
                <h2 class="section-title"><i class="fa-solid fa-map-location-dot"></i> Real-Time Map <span class="live-indicator">LIVE</span></h2>
                <div class="map-container" id="map">
                    <div class="map-controls">
                        <button class="map-btn" id="locate-btn" aria-label="Locate me">
                            <i class="fa-solid fa-location-crosshairs"></i>
                        </button>
                        <button class="map-btn" aria-label="Zoom in">
                            <i class="fa-solid fa-plus"></i>
                        </button>
                    </div>
                </div>
            </section>
            
            <section>
                <h2 class="section-title"><i class="fa-solid fa-clock"></i> Next Departures</h2>
                <div class="schedule-list">
                    <div class="schedule-item">
                        <div class="schedule-icon" style="background: #5E6AD2;"><i class="fa-solid fa-bus"></i></div>
                        <div class="schedule-content">
                            <div class="schedule-route">A-1 Express to Colaba</div>
                            <div class="schedule-time">Next: 2 min • Every 10-15 min</div>
                        </div>
                    </div>
                    <div class="schedule-item">
                        <div class="schedule-icon" style="background: #00B87A;"><i class="fa-solid fa-train-subway"></i></div>
                        <div class="schedule-content">
                            <div class="schedule-route">Western Line to Churchgate</div>
                            <div class="schedule-time">Next: 4 min • Every 3-5 min</div>
                        </div>
                    </div>
                    <div class="schedule-item">
                        <div class="schedule-icon" style="background: #8B5CF6;"><i class="fa-solid fa-train-tram"></i></div>
                        <div class="schedule-content">
                            <div class="schedule-route">Metro Line 1 to Versova</div>
                            <div class="schedule-time">Next: 6 min • Every 8-10 min</div>
                        </div>
                    </div>
                    <div class="schedule-item">
                        <div class="schedule-icon" style="background: #0EA5E9;"><i class="fa-solid fa-ship"></i></div>
                        <div class="schedule-content">
                            <div class="schedule-route">Ferry to Elephanta Island</div>
                            <div class="schedule-time">Next: 25 min • Every 45 min</div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section>
                <h2 class="section-title"><i class="fa-solid fa-bolt"></i> Quick Actions</h2>
                <div class="action-grid">
                    <button class="action-button">
                        <span class="action-icon"><i class="fa-solid fa-ticket"></i></span> 
                        Buy Ticket
                    </button>
                    <button class="action-button">
                        <span class="action-icon"><i class="fa-solid fa-route"></i></span> 
                        Plan Journey
                    </button>
                    <button class="action-button">
                        <span class="action-icon"><i class="fa-solid fa-map-pin"></i></span> 
                        Nearby Stations
                    </button>
                    <button class="action-button">
                        <span class="action-icon"><i class="fa-solid fa-wallet"></i></span> 
                        Recharge Card
                    </button>
                </div>
            </section>
            
            <section>
                <h2 class="section-title"><i class="fa-solid fa-triangle-exclamation"></i> Service Updates</h2>
                <div class="updates-list">
                    <div class="update-item">
                        <div class="update-icon" style="background: var(--success);"><i class="fa-solid fa-circle-check"></i></div>
                        <div class="update-content">
                            <div class="update-text">Metro Line 3 now operational between Bandra and Colaba</div>
                            <div class="update-time"><i class="fa-regular fa-clock"></i> 15 min ago</div>
                        </div>
                    </div>
                    <div class="update-item">
                        <div class="update-icon" style="background: var(--warning);"><i class="fa-solid fa-triangle-exclamation"></i></div>
                        <div class="update-content">
                            <div class="update-text">Delays on Harbour Line due to signal issues - expect 10-15 min delays</div>
                            <div class="update-time"><i class="fa-regular fa-clock"></i> 42 min ago</div>
                        </div>
                    </div>
                    <div class="update-item">
                        <div class="update-icon" style="background: var(--info);"><i class="fa-solid fa-circle-info"></i></div>
                        <div class="update-content">
                            <div class="update-text">New AC bus service launched on route 505 (Bandra to Powai)</div>
                            <div class="update-time"><i class="fa-regular fa-clock"></i> 2 hours ago</div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
        
        <nav class="bottom-nav">
            <button class="nav-button active">
                <i class="nav-icon fa-solid fa-house"></i>
                Home
            </button>
            <button class="nav-button">
                <i class="nav-icon fa-solid fa-map-location"></i>
                Map
            </button>
            <button class="nav-button">
                <i class="nav-icon fa-solid fa-ticket"></i>
                Tickets
            </button>
            <button class="nav-button">
                <i class="nav-icon fa-solid fa-user"></i>
                Account
            </button>
        </nav>
    </div>

    <script src="https://api.mapbox.com/mapbox-gl-js/v3.0.0/mapbox-gl.js"></script>
    <script>
        // Initialize Mapbox with latest API
        mapboxgl.accessToken = 'pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA';
        
        const map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v12',
            center: [72.8777, 19.0760], // Mumbai coordinates
            zoom: 11
        });
        
        // Add navigation controls
        map.addControl(new mapboxgl.NavigationControl(), 'bottom-right');
        
        // Add geolocate control
        map.addControl(new mapboxgl.GeolocateControl({
            positionOptions: {
                enableHighAccuracy: true
            },
            trackUserLocation: true,
            showUserHeading: true
        }), 'bottom-right');
        
        // Add real-time transport markers
        map.on('load', () => {
            // Add bus markers
            const buses = [
                {id: 'bus1', lng: 72.831, lat: 19.052, route: 'A-101'},
                {id: 'bus2', lng: 72.845, lat: 19.067, route: 'C-72'},
                {id: 'bus3', lng: 72.865, lat: 19.082, route: '27 LTD'},
                {id: 'bus4', lng: 72.892, lat: 19.095, route: 'AC-5'}
            ];
            
            buses.forEach(bus => {
                new mapboxgl.Marker({
                    color: '#5E6AD2',
                    scale: 0.8
                })
                .setLngLat([bus.lng, bus.lat])
                .setPopup(new mapboxgl.Popup().setHTML(`<strong>BEST Bus ${bus.route}</strong><br>To: Colaba Depot<br>Next stop: Bandra`))
                .addTo(map);
            });
            
            // Add train markers
            const trains = [
                {id: 'train1', lng: 72.842, lat: 19.072, line: 'Western'},
                {id: 'train2', lng: 72.878, lat: 19.091, line: 'Central'},
                {id: 'train3', lng: 72.910, lat: 19.062, line: 'Harbour'}
            ];
            
            trains.forEach(train => {
                new mapboxgl.Marker({
                    color: '#00B87A',
                    scale: 0.8
                })
                .setLngLat([train.lng, train.lat])
                .setPopup(new mapboxgl.Popup().setHTML(`<strong>${train.line} Line</strong><br>To: Churchgate<br>Next stop: Dadar`))
                .addTo(map);
            });
            
            // Add metro markers
            const metros = [
                {id: 'metro1', lng: 72.831, lat: 19.082, line: 'Line 1'},
                {id: 'metro2', lng: 72.865, lat: 19.095, line: 'Line 2A'},
                {id: 'metro3', lng: 72.890, lat: 19.072, line: 'Line 3'}
            ];
            
            metros.forEach(metro => {
                new mapboxgl.Marker({
                    color: '#8B5CF6',
                    scale: 0.8
                })
                .setLngLat([metro.lng, metro.lat])
                .setPopup(new mapboxgl.Popup().setHTML(`<strong>Metro ${metro.line}</strong><br>To: Ghatkopar<br>Next stop: Andheri`))
                .addTo(map);
            });
            
            // Add ferry marker
            new mapboxgl.Marker({
                color: '#0EA5E9',
                scale: 0.8
            })
            .setLngLat([72.821, 19.002])
            .setPopup(new mapboxgl.Popup().setHTML('<strong>Ferry to Elephanta Island</strong><br>Departing in 15 min'))
            .addTo(map);
            
            // Add route from Bandra to Colaba
            const route = {
                'type': 'FeatureCollection',
                'features': [
                    {
                        'type': 'Feature',
                        'geometry': {
                            'type': 'LineString',
                            'coordinates': [
                                [72.831, 19.052], // Bandra
                                [72.838, 19.048],
                                [72.845, 19.045],
                                [72.852, 19.042],
                                [72.860, 19.038],
                                [72.868, 19.035],
                                [72.877, 19.032], // Colaba
                            ]
                        }
                    }
                ]
            };
            
            map.addSource('route', {
                'type': 'geojson',
                'data': route
            });
            
            map.addLayer({
                'id': 'route',
                'type': 'line',
                'source': 'route',
                'layout': {
                    'line-join': 'round',
                    'line-cap': 'round'
                },
                'paint': {
                    'line-color': '#5E6AD2',
                    'line-width': 4,
                    'line-opacity': 0.7
                }
            });
        });
        
        // Theme toggle functionality
        document.getElementById('theme-toggle').addEventListener('click', function() {
            const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
            document.documentElement.setAttribute('data-theme', isDark ? 'light' : 'dark');
            this.querySelector('i').className = isDark ? 'fa-solid fa-moon' : 'fa-solid fa-sun';
            localStorage.setItem('theme', isDark ? 'light' : 'dark');
        });
        
        // Set initial theme based on user preference
        if (localStorage.getItem('theme') === 'dark' || 
            (window.matchMedia('(prefers-color-scheme: dark)').matches && !localStorage.getItem('theme'))) {
            document.documentElement.setAttribute('data-theme', 'dark');
            document.getElementById('theme-toggle').querySelector('i').className = 'fa-solid fa-sun';
        }
        
        // Locate button functionality
        document.getElementById('locate-btn').addEventListener('click', function() {
            navigator.geolocation.getCurrentPosition(position => {
                map.flyTo({
                    center: [position.coords.longitude, position.coords.latitude],
                    zoom: 14
                });
                
                // Add user marker
                new mapboxgl.Marker({
                    color: '#FF6B6B',
                    scale: 1
                })
                .setLngLat([position.coords.longitude, position.coords.latitude])
                .setPopup(new mapboxgl.Popup().setHTML('<strong>Your Location</strong>'))
                .addTo(map);
            }, error => {
                alert('Unable to get your location. Please enable location services.');
            });
        });
        
        // Simulate real-time updates
        setInterval(() => {
            // Update live indicators
            document.querySelectorAll('.live-indicator').forEach(el => {
                el.style.animation = 'none';
                setTimeout(() => el.style.animation = null, 10);
            });
            
            // Update transport status
            const statuses = document.querySelectorAll('.card-status-text');
            statuses.forEach(status => {
                if (Math.random() > 0.8) {
                    status.textContent = Math.random() > 0.5 ? 'Minor Delays' : 'Operational';
                    status.previousElementSibling.className = 
                        `status-indicator ${status.textContent.includes('Delays') ? 'status-delayed' : 'status-active'}`;
                }
            });
            
            // Update next departures
            const times = document.querySelectorAll('.schedule-time');
            times.forEach(time => {
                const current = parseInt(time.textContent.match(/\d+/)[0]);
                if (current > 1 && Math.random() > 0.7) {
                    time.textContent = time.textContent.replace(current, current - 1);
                } else if (current === 1) {
                    time.textContent = time.textContent.replace(current, Math.floor(Math.random() * 10) + 3);
                }
            });
        }, 30000);
    </script>
</body>
</html>
